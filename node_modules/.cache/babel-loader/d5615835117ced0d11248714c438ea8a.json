{"ast":null,"code":"'use strict';\n\nvar use = require('use');\n\nvar define = require('define-property');\n\nvar debug = require('debug')('snapdragon:compiler');\n\nvar utils = require('./utils');\n/**\r\n * Create a new `Compiler` with the given `options`.\r\n * @param {Object} `options`\r\n */\n\n\nfunction Compiler(options, state) {\n  debug('initializing', __filename);\n  this.options = utils.extend({\n    source: 'string'\n  }, options);\n  this.state = state || {};\n  this.compilers = {};\n  this.output = '';\n  this.set('eos', function (node) {\n    return this.emit(node.val, node);\n  });\n  this.set('noop', function (node) {\n    return this.emit(node.val, node);\n  });\n  this.set('bos', function (node) {\n    return this.emit(node.val, node);\n  });\n  use(this);\n}\n/**\r\n * Prototype methods\r\n */\n\n\nCompiler.prototype = {\n  /**\r\n   * Throw an error message with details including the cursor position.\r\n   * @param {String} `msg` Message to use in the Error.\r\n   */\n  error: function (msg, node) {\n    var pos = node.position || {\n      start: {\n        column: 0\n      }\n    };\n    var message = this.options.source + ' column:' + pos.start.column + ': ' + msg;\n    var err = new Error(message);\n    err.reason = msg;\n    err.column = pos.start.column;\n    err.source = this.pattern;\n\n    if (this.options.silent) {\n      this.errors.push(err);\n    } else {\n      throw err;\n    }\n  },\n\n  /**\r\n   * Define a non-enumberable property on the `Compiler` instance.\r\n   *\r\n   * ```js\r\n   * compiler.define('foo', 'bar');\r\n   * ```\r\n   * @name .define\r\n   * @param {String} `key` propery name\r\n   * @param {any} `val` property value\r\n   * @return {Object} Returns the Compiler instance for chaining.\r\n   * @api public\r\n   */\n  define: function (key, val) {\n    define(this, key, val);\n    return this;\n  },\n\n  /**\r\n   * Emit `node.val`\r\n   */\n  emit: function (str, node) {\n    this.output += str;\n    return str;\n  },\n\n  /**\r\n   * Add a compiler `fn` with the given `name`\r\n   */\n  set: function (name, fn) {\n    this.compilers[name] = fn;\n    return this;\n  },\n\n  /**\r\n   * Get compiler `name`.\r\n   */\n  get: function (name) {\n    return this.compilers[name];\n  },\n\n  /**\r\n   * Get the previous AST node.\r\n   */\n  prev: function (n) {\n    return this.ast.nodes[this.idx - (n || 1)] || {\n      type: 'bos',\n      val: ''\n    };\n  },\n\n  /**\r\n   * Get the next AST node.\r\n   */\n  next: function (n) {\n    return this.ast.nodes[this.idx + (n || 1)] || {\n      type: 'eos',\n      val: ''\n    };\n  },\n\n  /**\r\n   * Visit `node`.\r\n   */\n  visit: function (node, nodes, i) {\n    var fn = this.compilers[node.type];\n    this.idx = i;\n\n    if (typeof fn !== 'function') {\n      throw this.error('compiler \"' + node.type + '\" is not registered', node);\n    }\n\n    return fn.call(this, node, nodes, i);\n  },\n\n  /**\r\n   * Map visit over array of `nodes`.\r\n   */\n  mapVisit: function (nodes) {\n    if (!Array.isArray(nodes)) {\n      throw new TypeError('expected an array');\n    }\n\n    var len = nodes.length;\n    var idx = -1;\n\n    while (++idx < len) {\n      this.visit(nodes[idx], nodes, idx);\n    }\n\n    return this;\n  },\n\n  /**\r\n   * Compile `ast`.\r\n   */\n  compile: function (ast, options) {\n    var opts = utils.extend({}, this.options, options);\n    this.ast = ast;\n    this.parsingErrors = this.ast.errors;\n    this.output = ''; // source map support\n\n    if (opts.sourcemap) {\n      var sourcemaps = require('./source-maps');\n\n      sourcemaps(this);\n      this.mapVisit(this.ast.nodes);\n      this.applySourceMaps();\n      this.map = opts.sourcemap === 'generator' ? this.map : this.map.toJSON();\n      return this;\n    }\n\n    this.mapVisit(this.ast.nodes);\n    return this;\n  }\n};\n/**\r\n * Expose `Compiler`\r\n */\n\nmodule.exports = Compiler;","map":{"version":3,"sources":["C:/frontend/node_modules/snapdragon/lib/compiler.js"],"names":["use","require","define","debug","utils","Compiler","options","state","__filename","extend","source","compilers","output","set","node","emit","val","prototype","error","msg","pos","position","start","column","message","err","Error","reason","pattern","silent","errors","push","key","str","name","fn","get","prev","n","ast","nodes","idx","type","next","visit","i","call","mapVisit","Array","isArray","TypeError","len","length","compile","opts","parsingErrors","sourcemap","sourcemaps","applySourceMaps","map","toJSON","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar use = require('use');\r\nvar define = require('define-property');\r\nvar debug = require('debug')('snapdragon:compiler');\r\nvar utils = require('./utils');\r\n\r\n/**\r\n * Create a new `Compiler` with the given `options`.\r\n * @param {Object} `options`\r\n */\r\n\r\nfunction Compiler(options, state) {\r\n  debug('initializing', __filename);\r\n  this.options = utils.extend({source: 'string'}, options);\r\n  this.state = state || {};\r\n  this.compilers = {};\r\n  this.output = '';\r\n  this.set('eos', function(node) {\r\n    return this.emit(node.val, node);\r\n  });\r\n  this.set('noop', function(node) {\r\n    return this.emit(node.val, node);\r\n  });\r\n  this.set('bos', function(node) {\r\n    return this.emit(node.val, node);\r\n  });\r\n  use(this);\r\n}\r\n\r\n/**\r\n * Prototype methods\r\n */\r\n\r\nCompiler.prototype = {\r\n\r\n  /**\r\n   * Throw an error message with details including the cursor position.\r\n   * @param {String} `msg` Message to use in the Error.\r\n   */\r\n\r\n  error: function(msg, node) {\r\n    var pos = node.position || {start: {column: 0}};\r\n    var message = this.options.source + ' column:' + pos.start.column + ': ' + msg;\r\n\r\n    var err = new Error(message);\r\n    err.reason = msg;\r\n    err.column = pos.start.column;\r\n    err.source = this.pattern;\r\n\r\n    if (this.options.silent) {\r\n      this.errors.push(err);\r\n    } else {\r\n      throw err;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Define a non-enumberable property on the `Compiler` instance.\r\n   *\r\n   * ```js\r\n   * compiler.define('foo', 'bar');\r\n   * ```\r\n   * @name .define\r\n   * @param {String} `key` propery name\r\n   * @param {any} `val` property value\r\n   * @return {Object} Returns the Compiler instance for chaining.\r\n   * @api public\r\n   */\r\n\r\n  define: function(key, val) {\r\n    define(this, key, val);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Emit `node.val`\r\n   */\r\n\r\n  emit: function(str, node) {\r\n    this.output += str;\r\n    return str;\r\n  },\r\n\r\n  /**\r\n   * Add a compiler `fn` with the given `name`\r\n   */\r\n\r\n  set: function(name, fn) {\r\n    this.compilers[name] = fn;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Get compiler `name`.\r\n   */\r\n\r\n  get: function(name) {\r\n    return this.compilers[name];\r\n  },\r\n\r\n  /**\r\n   * Get the previous AST node.\r\n   */\r\n\r\n  prev: function(n) {\r\n    return this.ast.nodes[this.idx - (n || 1)] || { type: 'bos', val: '' };\r\n  },\r\n\r\n  /**\r\n   * Get the next AST node.\r\n   */\r\n\r\n  next: function(n) {\r\n    return this.ast.nodes[this.idx + (n || 1)] || { type: 'eos', val: '' };\r\n  },\r\n\r\n  /**\r\n   * Visit `node`.\r\n   */\r\n\r\n  visit: function(node, nodes, i) {\r\n    var fn = this.compilers[node.type];\r\n    this.idx = i;\r\n\r\n    if (typeof fn !== 'function') {\r\n      throw this.error('compiler \"' + node.type + '\" is not registered', node);\r\n    }\r\n    return fn.call(this, node, nodes, i);\r\n  },\r\n\r\n  /**\r\n   * Map visit over array of `nodes`.\r\n   */\r\n\r\n  mapVisit: function(nodes) {\r\n    if (!Array.isArray(nodes)) {\r\n      throw new TypeError('expected an array');\r\n    }\r\n    var len = nodes.length;\r\n    var idx = -1;\r\n    while (++idx < len) {\r\n      this.visit(nodes[idx], nodes, idx);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Compile `ast`.\r\n   */\r\n\r\n  compile: function(ast, options) {\r\n    var opts = utils.extend({}, this.options, options);\r\n    this.ast = ast;\r\n    this.parsingErrors = this.ast.errors;\r\n    this.output = '';\r\n\r\n    // source map support\r\n    if (opts.sourcemap) {\r\n      var sourcemaps = require('./source-maps');\r\n      sourcemaps(this);\r\n      this.mapVisit(this.ast.nodes);\r\n      this.applySourceMaps();\r\n      this.map = opts.sourcemap === 'generator' ? this.map : this.map.toJSON();\r\n      return this;\r\n    }\r\n\r\n    this.mapVisit(this.ast.nodes);\r\n    return this;\r\n  }\r\n};\r\n\r\n/**\r\n * Expose `Compiler`\r\n */\r\n\r\nmodule.exports = Compiler;\r\n"]},"metadata":{},"sourceType":"script"}