(this["webpackJsonpamplify-graphiql-explorer"]=this["webpackJsonpamplify-graphiql-explorer"]||[]).push([[0],{413:function(e,t,n){},488:function(e,t,n){},492:function(e,t){},494:function(e,t){},507:function(e,t){},509:function(e,t){},537:function(e,t){},538:function(e,t){},543:function(e,t){},545:function(e,t){},552:function(e,t){},571:function(e,t){},607:function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o),a=n(84),r=n.n(a),s=(n(413),n(60)),c=n(31),l=n.n(c),u=n(357),h=n(73),d=n(74),O=n(61),p=n(224),I=n(215),j=n(54),f=n(92),b=n(393),g=n.n(b),A=(n(486),n(68)),T=n(271),C=n(608),m=(n(487),n(488),n(32)),y=n(634),k=n(631),M=n(633),v=n(632),N=n(171),_=n(635),E=n(609),x=n(229);function S(e){try{"string"===typeof e&&(e=JSON.parse(e));var t=Object(x.sign)(e,"open-secrete");return Object(x.verify)(t,"open-secrete"),t}catch(n){throw new Error("Error when generating OIDC token: "+n.message)}}function D(e){return Object(x.decode)(e)}function P(e,t){var n=D(e);if(!Object.keys(n).length)throw new Error("Invalid token ".concat(e));return t&&(n.iss=t),n.exp=Math.floor(Date.now()/100+2e4),S(JSON.stringify(n))}var J,W=n(11);!function(e){e.API_KEY="API_KEY",e.AMAZON_COGNITO_USER_POOLS="AMAZON_COGNITO_USER_POOLS",e.OPENID_CONNECT="OPENID_CONNECT",e.AWS_IAM="AWS_IAM"}(J||(J={}));var w=function(e){Object(p.a)(n,e);var t=Object(I.a)(n);function n(e){var o;Object(h.a)(this,n),(o=t.call(this,e)).state={currentCognitoToken:"",currentOIDCTokenDecoded:"",currentOIDCToken:"",userName:"",issuer:"",userGroups:[],apiKey:"",possibleGroups:[],email:"",supportedAuthModes:[J.API_KEY],isOpen:!0,currentAuthMode:J.API_KEY,oidcTokenError:""},o.onAdditionalFieldChange=function(e,t){o.setState({additionalFields:t.value})};var i=o.parseJWTToken(o.props.currentCognitoToken)||{},a={userName:i["cognito:username"]||"",userGroups:i["cognito:groups"]||[],issuer:i.iss,email:i.email,possibleGroups:i["cognito:groups"]||[]},r=["cognito:username","cognito:groups","iss","email","sub","aud","exp","event_id","iat","algorithm","auth_time"],s=Object.keys(i).filter((function(e){return!r.includes(e)})).reduce((function(e,t){return Object(j.a)(Object(j.a)({},e),{},Object(m.a)({},t,i[t]))}),{});return o.state=Object(j.a)(Object(j.a)(Object(j.a)({},o.state),a),{},{additionalFields:JSON.stringify(s,null,4),currentCognitoToken:o.props.currentCognitoToken||"",currentOIDCToken:o.props.currentOIDCToken||"",currentOIDCTokenDecoded:JSON.stringify(o.parseJWTToken(o.props.currentOIDCToken),null,4)||"",apiKey:e.apiKey||"",supportedAuthModes:o.props.authModes,currentAuthMode:e.selectedAuthMode}),o.onClose=o.onClose.bind(Object(O.a)(o)),o.onGroupChange=o.onGroupChange.bind(Object(O.a)(o)),o.onGroupAdd=o.onGroupAdd.bind(Object(O.a)(o)),o.onGenerate=o.onGenerate.bind(Object(O.a)(o)),o.changeAPIKey=o.changeAPIKey.bind(Object(O.a)(o)),o.changeEmail=o.changeEmail.bind(Object(O.a)(o)),o.onUserNameChange=o.onUserNameChange.bind(Object(O.a)(o)),o.onOIDCTokenChange=o.onOIDCTokenChange.bind(Object(O.a)(o)),o.onAuthModeChange=o.onAuthModeChange.bind(Object(O.a)(o)),o}return Object(d.a)(n,[{key:"onClose",value:function(){var e={authMode:this.state.currentAuthMode,apiKey:this.state.currentAuthMode===J.API_KEY?this.state.apiKey:null,cognitoToken:this.state.currentAuthMode===J.AMAZON_COGNITO_USER_POOLS?this.state.currentCognitoToken:null,OIDCToken:this.state.currentAuthMode===J.OPENID_CONNECT?this.state.currentOIDCToken:null,iam:this.state.currentAuthMode===J.AWS_IAM?"AWS4-HMAC-SHA256 IAMAuthorized":null};this.props.onClose&&this.props.onClose(e)}},{key:"onGroupChange",value:function(e,t){this.setState({userGroups:t.value})}},{key:"onGroupAdd",value:function(e,t){this.setState({possibleGroups:[].concat(Object(s.a)(this.state.possibleGroups),[t.value])})}},{key:"onUserNameChange",value:function(e,t){this.setState({userName:t.value})}},{key:"onOIDCTokenChange",value:function(e,t){this.setState({currentOIDCTokenDecoded:t.value})}},{key:"onAuthModeChange",value:function(e,t){this.setState({currentAuthMode:t.value})}},{key:"changeEmail",value:function(e,t){this.setState({email:t.value})}},{key:"changeAPIKey",value:function(e,t){this.setState({apiKey:t.value})}},{key:"render",value:function(){var e,t="Save";if(this.state.currentAuthMode===J.API_KEY)e=Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"ApiKey"}),Object(W.jsx)(k.a,{readOnly:!0,placeholder:"APIKey",value:this.state.apiKey,onChange:this.changeAPIKey})]})});else if(this.state.currentAuthMode===J.AMAZON_COGNITO_USER_POOLS)t="Generate Token",e=Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"Username"}),Object(W.jsx)(k.a,{placeholder:"User Name",value:this.state.userName,onChange:this.onUserNameChange})]}),Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"Groups"}),Object(W.jsx)(M.a,{placeholder:"Choose cognito user groups",search:!0,options:this.state.possibleGroups.map((function(e){return{key:e,value:e,text:e}})),selection:!0,fluid:!0,multiple:!0,allowAdditions:!0,value:this.state.userGroups,onAddItem:this.onGroupAdd,onChange:this.onGroupChange})]}),Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"Email"}),Object(W.jsx)(k.a,{placeholder:"Email",value:this.state.email,onChange:this.changeEmail})]}),Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"Additional Fields"}),Object(W.jsx)(v.a,{onChange:this.onAdditionalFieldChange,rows:10,placeholder:"Decoded OIDC Token",spellCheck:"false",value:this.state.additionalFields})]})]});else if(this.state.currentAuthMode===J.OPENID_CONNECT){var n=this.state.oidcTokenError?Object(W.jsx)(N.a,{basic:!0,color:"red",pointing:"below",children:this.state.oidcTokenError}):null;e=Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(y.a.Field,{children:[Object(W.jsx)("label",{children:"Decoded OpenID Connect Token"}),n,Object(W.jsx)(v.a,{onChange:this.onOIDCTokenChange,rows:10,placeholder:"Decoded OIDC Token",spellCheck:"false",value:this.state.currentOIDCTokenDecoded})]})})}else this.state.currentAuthMode===J.AWS_IAM&&(e=Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("label",{children:"IAM authentication mode has no settings."})}));var o=this.state.supportedAuthModes.filter((function(e){return e})).map((function(e){return{key:e,value:e,text:e}}));return Object(W.jsxs)(_.a,{onClose:this.onClose,onActionClick:this.onGenerate,open:this.state.isOpen,children:[Object(W.jsx)(_.a.Header,{children:"Auth Options"}),Object(W.jsx)(_.a.Content,{children:Object(W.jsxs)(_.a.Description,{children:[Object(W.jsx)(M.a,{placeholder:"Auth Mode",selection:!0,options:o,value:this.state.currentAuthMode,onChange:this.onAuthModeChange}),Object(W.jsx)("div",{style:{marginTop:"1em"},children:Object(W.jsx)(y.a,{children:e})})]})}),Object(W.jsx)(_.a.Actions,{children:Object(W.jsx)(E.a,{primary:!0,onClick:this.onGenerate,children:t})})]})}},{key:"onGenerate",value:function(){var e=this;try{var t={isOpen:!1};this.state.currentAuthMode===J.AMAZON_COGNITO_USER_POOLS?t.currentCognitoToken=this.generateCognitoJWTToken():this.state.currentAuthMode===J.OPENID_CONNECT&&(t.currentOIDCToken=this.generateOIDCJWTToken()),this.setState(t,(function(){e.onClose()}))}catch(n){}}},{key:"generateCognitoJWTToken",value:function(){var e;try{var t;e=JSON.parse((null===(t=this.state.additionalFields)||void 0===t?void 0:t.trim())||"{}")}catch(o){e={}}var n=Object(j.a)({sub:"7d8ca528-4931-4254-9273-ea5ee853f271","cognito:groups":[],email_verified:!0,algorithm:"HS256",iss:"https://cognito-idp.us-east-1.amazonaws.com/us-east-1_fake_idp",phone_number_verified:!0,"cognito:username":"","cognito:roles":[],aud:"2hifa096b3a24mvm3phskuaqi3",event_id:"18f4067e-9985-4eae-9f33-f45f495470d0",token_use:"id",phone_number:"+12062062016",exp:Math.floor(Date.now()/1e3)+43200,email:this.state.email},e);return n["cognito:username"]=this.state.userName,n["cognito:groups"]=this.state.userGroups,n.auth_time=Math.floor(Date.now()/1e3),S(n)}},{key:"generateOIDCJWTToken",value:function(){var e=this.state.currentOIDCTokenDecoded||"";try{return S(e)}catch(t){throw this.setState({oidcTokenError:t.message}),t}}},{key:"parseJWTToken",value:function(e){return D(e)}}]),n}(o.Component),G="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI3ZDhjYTUyOC00OTMxLTQyNTQtOTI3My1lYTVlZTg1M2YyNzEiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS91cy1lYXN0LTFfZmFrZSIsInBob25lX251bWJlcl92ZXJpZmllZCI6dHJ1ZSwiY29nbml0bzp1c2VybmFtZSI6InVzZXIxIiwiYXVkIjoiMmhpZmEwOTZiM2EyNG12bTNwaHNrdWFxaTMiLCJldmVudF9pZCI6ImIxMmEzZTJmLTdhMzYtNDkzYy04NWIzLTIwZDgxOGJkNzhhMSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxOTc0MjY0NDEyLCJwaG9uZV9udW1iZXIiOiIrMTIwNjIwNjIwMTYiLCJleHAiOjE1NjQyNjgwMTIsImlhdCI6MTU2NDI2NDQxMywiZW1haWwiOiJ1c2VyQGRvbWFpbi5jb20ifQ.wHKY2KIhvWn4zpJ4TZ1vS3zRE9mGWsLY4NCV2Cof17Q",Y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL3NvbWUtb2lkYy1wcm92aWRlci9hdXRoIiwicGhvbmVfbnVtYmVyX3ZlcmlmaWVkIjp0cnVlLCJhdWQiOiIyaGlmYTA5NmIzYTI0bXZtM3Boc2t1YXFpMyIsImV2ZW50X2lkIjoiYjEyYTNlMmYtN2EzNi00OTNjLTg1YjMtMjBkODE4YmQ3OGExIiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE5NzQyNjQ0MTIsInBob25lX251bWJlciI6IisxMjA2MjA2MjAxNiIsImV4cCI6MTU2NDI2ODAxMiwiaWF0IjoxNTY0MjY0NDEzLCJlbWFpbCI6InVzZXJAZG9tYWluLmNvbSJ9.uAegFXomOnA7Dkl-5FcS5icu5kL9Juqb81GnTrOZZqM",L={AMAZON_COGNITO_USER_POOLS:"User Pool",API_KEY:"API Key",OPENID_CONNECT:"Open ID",AWS_IAM:"IAM"},F={name:"AppSyncTransformer",defaultAuthenticationType:{authenticationType:"API_KEY"},additionalAuthenticationProviders:[],apiKey:"da2-fakeApiId123456"},K="AMPLIFY_GRPAHIQL_EXPLORER_COGNITO_JWT_TOKEN",Z="AMPLIFY_GRPAHIQL_EXPLORER_OIDC_JWT_TOKEN",R="AMPLIFY_GRPAHIQL_EXPLORER_API_KEY",V="AMPLIFY_GRPAHIQL_EXPLORER_AWS_IAM";function X(e,t){var n=Object(j.a)({Accept:"application/json","Content-Type":"application/json"},t);return fetch("/graphql",{method:"POST",headers:n,body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){try{return JSON.parse(e)}catch(t){return e}}))}var z=function(e){Object(p.a)(n,e);var t=Object(I.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e))._graphiql=void 0,o.state={schema:null,query:"# shift-option/alt-click on a query below to jump to it in the explorer\n# option/alt-click on a field in the explorer to select all subfields\n",explorerIsOpen:!0,authModalVisible:!1,apiInfo:F,currentAuthMode:J.API_KEY,credentials:{apiKey:"",cognitoJWTToken:"",oidcJWTToken:"",iam:""}},o.toggleAuthModal=function(){return o.setState((function(e){return{authModalVisible:!e.authModalVisible}}))},o.switchAuthMode=function(e){o.setState({currentAuthMode:e})},o._handleInspectOperation=function(e,t){var n=Object(A.a)(o.state.query||"");if(!n)return console.error("Couldn't parse query document"),null;var i=e.getTokenAt(t),a={line:t.line,ch:i.start},r={line:t.line,ch:i.end},s={start:e.indexFromPos(a),end:e.indexFromPos(r)},c=n.definitions.find((function(e){if(!e.loc)return console.log("Missing location information for definition"),!1;var t=e.loc,n=t.start,o=t.end;return n<=s.start&&o>=s.end}));if(!c)return console.error("Unable to find definition corresponding position at ".concat(s.start)),null;var l="OperationDefinition"===c.kind?c.operation:"FragmentDefinition"===c.kind?"fragment":"unknown",u="OperationDefinition"===c.kind&&c.name||"FragmentDefinition"===c.kind&&c.name?c.name.value:"unknown",h=".graphiql-explorer-root #".concat(l,"-").concat(u),d=document.querySelector(h);d&&d.scrollIntoView()},o._handleEditQuery=function(e){return o.setState({query:e})},o._handleToggleExplorer=function(){o.setState({explorerIsOpen:!o.state.explorerIsOpen})},o.fetch=o.fetch.bind(Object(O.a)(o)),o}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api-config").then((function(e){return e.json()}));case 2:return n=e.sent,this.loadCredentials(n),this.setState({apiInfo:n}),e.next=7,this.fetch({query:Object(T.a)()});case 7:o=e.sent,(i=null===(t=this._graphiql)||void 0===t?void 0:t.getQueryEditor()).setOption("extraKeys",Object(j.a)(Object(j.a)({},i.options.extraKeys||{}),{},{"Shift-Alt-LeftClick":this._handleInspectOperation})),o&&o.data&&this.setState({schema:Object(C.a)(o.data)});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){var t={};return this.state.currentAuthMode===J.API_KEY?t["x-api-key"]=this.state.credentials.apiKey:this.state.currentAuthMode===J.AMAZON_COGNITO_USER_POOLS?t.Authorization=this.state.credentials.cognitoJWTToken:this.state.currentAuthMode===J.OPENID_CONNECT?t.Authorization=this.state.credentials.oidcJWTToken:this.state.currentAuthMode===J.AWS_IAM&&(t.Authorization=this.state.credentials.iam),X(e,t)}},{key:"storeCredentials",value:function(e){var t=this.state.apiInfo,n={apiInfo:Object(j.a)(Object(j.a)({},t),{},{authenticationType:e.authMode})};"API_KEY"===e.authMode?(n.apiKey=e.apiKey,window.localStorage.setItem(R,e.apiKey)):e.authMode===J.AMAZON_COGNITO_USER_POOLS?(n.cognitoJWTToken=e.cognitoToken,window.localStorage.setItem(K,e.cognitoToken)):e.authMode===J.OPENID_CONNECT?(n.oidcJWTToken=e.OIDCToken,window.localStorage.setItem(Z,e.OIDCToken)):e.authMode===J.AWS_IAM&&(n.oidcJWTToken=e.IAM,window.localStorage.setItem(V,e.iam)),this.setState((function(t){return{credentials:Object(j.a)(Object(j.a)({},t.credentials),n),currentAuthMode:e.authMode}}))}},{key:"loadCredentials",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.apiInfo,t={},n=[e.defaultAuthenticationType].concat(Object(s.a)(e.additionalAuthenticationProviders)),o=n.map((function(e){return e.authenticationType}));if(o.includes("API_KEY")&&(t.apiKey=F.apiKey),o.includes("AMAZON_COGNITO_USER_POOLS"))try{t.cognitoJWTToken=P(window.localStorage.getItem(K)||"")}catch(a){console.warn("Invalid Cognito token found in local storage. Using the default OIDC token"),t.cognitoJWTToken=P(G)}if(o.includes("OPENID_CONNECT")){var i=n.filter((function(e){return e.authenticationType===J.OPENID_CONNECT})).map((function(e){return e.openIDConnectConfig.Issuer}));try{t.oidcJWTToken=P(window.localStorage.getItem(Z)||"",i[0])}catch(a){console.warn("Invalid OIDC token found in local storage. Using the default OIDC token"),t.oidcJWTToken=P(Y,i[0])}}return o.includes("AWS_IAM")&&(t.iam="AWS4-HMAC-SHA256 IAMAuthorized"),this.setState((function(){return{currentAuthMode:J[e.defaultAuthenticationType.authenticationType]||J.API_KEY}})),this.setState({credentials:t}),t}},{key:"render",value:function(){var e=this,t=this.state,n=t.query,o=t.schema,i=t.authModalVisible,a=t.apiInfo,r=[J[a.defaultAuthenticationType.authenticationType]].concat(Object(s.a)(a.additionalAuthenticationProviders.map((function(e){return J[e.authenticationType]})))).filter((function(e){return e})),c=i?Object(W.jsx)(w,{selectedAuthMode:this.state.currentAuthMode,currentOIDCToken:this.state.credentials.oidcJWTToken,currentCognitoToken:this.state.credentials.cognitoJWTToken,apiKey:this.state.credentials.apiKey,authModes:r,onClose:function(t){e.storeCredentials(t),e.setState({authModalVisible:!1})}}):null;return Object(W.jsxs)(W.Fragment,{children:[c,Object(W.jsxs)("div",{className:"graphiql-container",children:[Object(W.jsx)(g.a,{schema:o,query:n,onEdit:this._handleEditQuery,onRunOperation:function(t){var n;return null===(n=e._graphiql)||void 0===n?void 0:n.handleRunQuery(t)},explorerIsOpen:this.state.explorerIsOpen,onToggleExplorer:this._handleToggleExplorer}),Object(W.jsx)(f.a,{ref:function(t){return e._graphiql=t},fetcher:this.fetch,schema:o,query:n,onEditQuery:this._handleEditQuery,children:Object(W.jsxs)(f.a.Toolbar,{children:[Object(W.jsx)(f.a.Button,{onClick:function(){var t;return null===(t=e._graphiql)||void 0===t?void 0:t.handlePrettifyQuery()},label:"Prettify",title:"Prettify Query (Shift-Ctrl-P)"}),Object(W.jsx)(f.a.Button,{onClick:function(){var t;return null===(t=e._graphiql)||void 0===t?void 0:t.handleToggleHistory()},label:"History",title:"Show History"}),Object(W.jsx)(f.a.Button,{onClick:this._handleToggleExplorer,label:"Explorer",title:"Toggle Explorer"}),Object(W.jsx)(f.a.Button,{onClick:this.toggleAuthModal,label:"Update Auth",title:"Auth Setting"}),Object(W.jsx)(f.a.Menu,{label:"Auth - ".concat(L[this.state.currentAuthMode]," "),title:L[this.state.currentAuthMode],children:r.map((function(t){return Object(W.jsx)(f.a.MenuItem,{title:L[t],label:"Use: ".concat(L[t]),onSelect:function(){return e.switchAuthMode(t)}})}))})]})})]})]})}}]),n}(o.Component),U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,637)).then((function(t){var n=t.getCLS,o=t.getFID,i=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),o(e),i(e),a(e),r(e)}))};r.a.render(Object(W.jsx)(i.a.StrictMode,{children:Object(W.jsx)(z,{})}),document.getElementById("root")),U()}},[[607,1,2]]]);
//# sourceMappingURL=main.a4ed65bc.chunk.js.map